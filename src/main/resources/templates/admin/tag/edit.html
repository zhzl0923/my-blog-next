<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<div class="card mb-0">
    <div class="card-header">
        <h3 class="card-title">修改标签</h3>
    </div>
    <!-- /.card-header -->
    <!-- form start -->
    <div class="card-body">
        <form>
            <div class="form-group">
                <label for="tag">标签名称</label>
                <input id="tag" type="text" class="form-control" name="tag_name" th:value="${tag.tagName}"
                       placeholder="标签名称">
            </div>
            <input type="hidden" name="tag_id" th:value="${tag.id}">
            <div class="form-group">
                <button id="updateTag" type="button" class="btn btn-primary">保存</button>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript">
    $(function () {
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 800
        });
        $("#updateTag").click(() => {
            const tagName = $("input[name='tag_name']").val()
            const tagId = $("input[name='tag_id']").val()
            const _csrf = "[[${_csrf.getToken()}]]"
            $.ajax({
                url: "/admin/tag/update",
                method: "post",
                data: {tag_id: tagId, tag_name: tagName, _csrf: _csrf},
                success: (res) => {
                    if (res.code === 200) {
                        Toast.fire({
                            icon: 'success',
                            text: res.message
                        }).then(function () {
                            $(".modal").modal("hide")
                            window.location.reload()
                        })
                    } else {
                        Toast.fire({
                            icon: 'error',
                            text: res.message
                        }).then(function () {
                            $(".modal").modal("hide")
                            window.location.reload()
                        })
                    }

                },
                error: (res) => {
                    Toast.fire({
                        icon: 'error',
                        text: res.message
                    }).then(function () {
                        $(".modal").modal("hide")
                        window.location.reload()
                    })
                }
            })
        })
    })
</script>
</html>
